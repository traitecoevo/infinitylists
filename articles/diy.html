<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Create your own infinitylists • infinitylists</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create your own infinitylists">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">infinitylists</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/infinitylists.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/diy.html">Create your own infinitylists</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create your own infinitylists</h1>
            
      

      <div class="d-none name"><code>diy.Rmd</code></div>
    </div>

    
    
<p>One major benefit of infinitylists using a Living Atlas node is that
is gives users the ability to create their own version of infinitylists
for whichever Living Atlas you would like to use. Unfortunately, there
are some slight inconsistencies in data coverage and naming between
Living Atlas data providers. This makes creating your own infinitylists
not an entirely straightforward process but I hope this article will be
able to give you some guidance.</p>
<p>Here, I will walk through the process on how to adapt the source code
of infinitylists so you can create your own version of infinitylists for
any country and taxa of your choice.</p>
<p>If you have any questions about this process, please do not hesitate
and reach out but submitting an issue at the <a href="https://github.com/traitecoevo/infinitylists" class="external-link">infinitylists
repository</a>.</p>
<div class="section level3">
<h3 id="load-dependencies">Load dependencies<a class="anchor" aria-label="anchor" href="#load-dependencies"></a>
</h3>
<p>We are going to need a few packages to create your own infinitylists.
Go ahead and install these if you don’t have these in your version of R.
Otherwise, load them and we can get started</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"traitecoevo/infinitylists"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://traitecoevo.github.io/infinitylists/">infinitylists</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://galah.ala.org.au/R/" class="external-link">galah</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/apache/arrow/" class="external-link">arrow</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<p>You will need to register for a <a href="https://www.gbif.org/" class="external-link">GBIF
account</a>. Click on the “Login” button on the top left corner and
click on the “Register” tab. Note down your login credentials for
safe-keeping once you have verified your account and created a
password.</p>
</div>
<div class="section level3">
<h3 id="configure-galah">Configure galah<a class="anchor" aria-label="anchor" href="#configure-galah"></a>
</h3>
<p>We will be using <a href="https://galah.ala.org.au/R/" class="external-link">{galah}</a> to
download occurrence records used our infinitylist. To do so, we need to
configure the settings so the package knows to point to the Global GBIF
API.</p>
<p>Here I’ve saved the credentials in my R environment so its not shared
publicly. I can call on these environment variables using
<code><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv()</a></code>. You can also do so with
<code>usethis::edit_r_environ</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set atlas</span></span>
<span><span class="fu"><a href="https://galah.ala.org.au/R/reference/galah_config.html" class="external-link">galah_config</a></span><span class="op">(</span></span>
<span>  atlas <span class="op">=</span> <span class="st">"Global"</span>,</span>
<span>  username <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"GBIF_USERNAME"</span><span class="op">)</span>,</span>
<span>  password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"GBIF_PWD"</span><span class="op">)</span>,</span>
<span>  email <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"GBIF_EMAIL"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="submit-data-request">Submit data request<a class="anchor" aria-label="anchor" href="#submit-data-request"></a>
</h3>
<p>Once we have all that set up, we can request data from GBIF Global.
Here I am downloading records for the class <code>Arachnida</code>, from
years 2000 to 2004. Under <code>country_code</code>, I’ve specified
<code>"FR"</code> for records found in France. Here is a <a href="https://en.wikipedia.org/wiki/ISO_3166-2" class="external-link">list of codes</a> for
each country. The <code>download_gbif_obs</code> function will download
the records and say it internally inside the infinitylist R package so
you can use it immediately.</p>
<p>Note that depending on how many records are requested, the download
will take some time.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/download_gbif_obs.html">download_gbif_obs</a></span><span class="op">(</span><span class="st">"Arachnida"</span>,</span>
<span>                  min_year <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>                  max_year <span class="op">=</span> <span class="fl">2024</span>,</span>
<span>                  country_code <span class="op">=</span> <span class="st">"FR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pre-download-check">Pre-download check<a class="anchor" aria-label="anchor" href="#pre-download-check"></a>
</h3>
<p>You can check roughly how big your download is but using the
<code>query()</code> function with <code><a href="https://galah.ala.org.au/R/reference/atlas_counts.html" class="external-link">galah::atlas_counts()</a></code>.
Note this will not be the find number of records that goes into
infinitylist as we do further exclusions and data cleaning behind the
scenes.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/query_gbif_global.html">query_gbif_global</a></span><span class="op">(</span><span class="st">"Arachnida"</span>,</span>
<span>                  min_year <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>                  max_year <span class="op">=</span> <span class="fl">2024</span>,</span>
<span>                  country_code <span class="op">=</span> <span class="st">"FR"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">galah</span><span class="fu">::</span><span class="fu"><a href="https://galah.ala.org.au/R/reference/atlas_counts.html" class="external-link">atlas_counts</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>You can investigate the full download by specifying
<code>save_raw_data = TRUE</code> in
<code><a href="../reference/download_gbif_obs.html">download_gbif_obs()</a></code></p>
</div>
<div class="section level3">
<h3 id="upload-your-own-kml">Upload your own KML<a class="anchor" aria-label="anchor" href="#upload-your-own-kml"></a>
</h3>
<p>To make your viewing experience more flexible, we recommend uploading
a .KML. file of the country you downloaded data for. We downloaded the
outline of France <a href="https://cartographyvectors.com/map/260-france-outline" class="external-link">here</a>
and manually uploaded it to app using the “Upload KML” option.</p>
</div>
<div class="section level3">
<h3 id="launch-infinitylist-and-explore">Launch infinitylist and explore!<a class="anchor" aria-label="anchor" href="#launch-infinitylist-and-explore"></a>
</h3>
<p>Once the download is complete, you are all set! Launch infinitylist
and you will find your download under the dropdown menu “taxa”</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/infinitylistApp.html">infinitylistApp</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="open-downloaded-data">Open downloaded data<a class="anchor" aria-label="anchor" href="#open-downloaded-data"></a>
</h3>
<p>The following code identifies the file path of where your GBIF Global
records are downloaded if you want to open data in R or export it for
other uses. This is usually handy if you want to orientate the map to
where your download is from using <code>"Choose a lat/long"</code>.</p>
<p>In the next code chunk, replace <code>"Arachnida"</code> in the
<code>pattern</code> argument with the name of the taxa you have
downloaded data for in the previous step. This code will provide the
full file paths of objects that match the <code>pattern</code>
argument.</p>
<p>If you specified <code>save_raw_data = TRUE</code> in
<code><a href="../reference/download_gbif_obs.html">download_gbif_obs()</a></code>, this code will you two file paths. The
file with the prefix:</p>
<ul>
<li>
<code>"GBIF-preprocessed-"</code> is the raw download
<strong>before</strong> our data cleaning.</li>
<li>
<code>"Living-Atlas-"</code> is the final <strong>cleaned</strong>
download of the data you view in the app.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Locate file path of downloads</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"infinitylists"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"Arachnida"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Match for Arachnida</span></span></code></pre></div>
<p>Copy the file path and pasted it in the <code><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">read_parquet()</a></code>
function to open the download in R.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gbif_spiders</span> <span class="op">&lt;-</span> <span class="fu">arrow</span><span class="fu">::</span><span class="fu"><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">read_parquet</a></span><span class="op">(</span><span class="st">"infinitylists/inst/data/Living-Atlas-Arachnida-2024-10-16.parquet"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gbif_spiders</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 44,370 × 11</span></span>
<span><span class="co">#&gt;    Species        Genus Family `Collection Date`   Lat   Long `Voucher Type` Repository `Recorded by`</span></span>
<span><span class="co">#&gt;  * &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;        </span></span>
<span><span class="co">#&gt;  1 Phalangium op… Phal… Phala… 2024-04-19         48.8  2.42  Photograph     https://w… Titouan Gelez</span></span>
<span><span class="co">#&gt;  2 Synema globos… Syne… Thomi… 2022-07-17         44.3  0.890 Photograph     https://w… Maël Richon  </span></span>
<span><span class="co">#&gt;  3 Salticus scen… Salt… Salti… 2021-05-27         48.0 -1.71  Photograph     https://w… Xavier HURIEZ</span></span>
<span><span class="co">#&gt;  4 Alopecosa alb… Alop… Lycos… 2020-04-23         43.3  5.42  Photograph     https://w… Martin Galli </span></span>
<span><span class="co">#&gt;  5 Synema globos… Syne… Thomi… 2023-05-11         43.6  3.97  Photograph     https://w… Mike Hedde   </span></span>
<span><span class="co">#&gt;  6 Phalangium op… Phal… Phala… 2021-11-13         43.6  2.97  Photograph     https://w… Heikel B.    </span></span>
<span><span class="co">#&gt;  7 Philaeus chry… Phil… Salti… 2020-04-12         43.2  6.01  Photograph     https://w… Bernard Nogu…</span></span>
<span><span class="co">#&gt;  8 Philaeus chry… Phil… Salti… 2021-04-07         43.2  6.01  Photograph     https://w… Bernard Nogu…</span></span>
<span><span class="co">#&gt;  9 Trichoncoides… Tric… Linyp… 2024-02-08         43.4  5.18  Photograph     https://w… Julien Tchil…</span></span>
<span><span class="co">#&gt; 10 Lacinius horr… Laci… Phala… 2024-07-21         42.6  8.89  Photograph     https://w… Julien Botti…</span></span>
<span><span class="co">#&gt; # ℹ 44,360 more rows</span></span>
<span><span class="co">#&gt; # ℹ 2 more variables: `Establishment Means` &lt;lgl&gt;, Link &lt;chr&gt;</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Mesaglio, Will Cornwell, Fonti Kar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
